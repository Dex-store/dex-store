<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>DEX treading | متجر إلكتروني</title>
  <meta name="description" content="DEX treading - متجر خدمات ومنتجات رقمية للتداول"/>
  <style>
    :root{
      --bg:#070A12;
      --card:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.12);
      --text:#fff; --muted:#b8c2e6;
      --brand:#1e5bff; --brand2:#4f7cff;
      --ok:#27d17c; --danger:#ff5b5b;
      --shadow: 0 14px 34px rgba(0,0,0,.45);
      --r:18px; --r2:22px;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 520px at 18% -12%, rgba(30,91,255,.30), transparent 60%),
        radial-gradient(1200px 520px at 82% -12%, rgba(79,124,255,.22), transparent 60%),
        radial-gradient(900px 420px at 50% 110%, rgba(39,209,124,.10), transparent 55%),
        var(--bg);
    }
    a{color:inherit;text-decoration:none}
    button{font-family:inherit}
    .container{max-width:1160px;margin:0 auto;padding:18px}

    /* Topbar */
    .topbar{
      position:sticky;top:0;z-index:50;
      background:rgba(5,6,11,.72);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--border);
    }
    .topbar .container{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:12px;min-width:180px}
    .logo{
      width:46px;height:46px;border-radius:16px;
      background:linear-gradient(135deg,var(--brand),var(--brand2));
      box-shadow: 0 14px 22px rgba(30,91,255,.28);
      display:grid;place-items:center;
      font-weight:1000;letter-spacing:.5px;
    }
    .brandName{font-weight:1000;font-size:14px}
    .tagline{font-size:12px;color:var(--muted);line-height:1.2;margin-top:2px}

    .nav{display:flex;align-items:center;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:10px 14px;border-radius:14px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.06);
      color:var(--text);
      cursor:pointer;user-select:none;white-space:nowrap;
      transition:transform .08s ease, opacity .18s ease, background .18s ease;
    }
    .btn:hover{opacity:.96}
    .btn:active{transform:translateY(1px)}
    .btn.primary{border:none;background:linear-gradient(135deg,var(--brand),#2d5bff)}
    .btn.ok{border:none;background:linear-gradient(135deg,#2ad67a,#0aa36b)}
    .btn.danger{border:1px solid rgba(255,91,91,.35);background:rgba(255,91,91,.12);color:#ffd6d6}

    .cartBtn{position:relative}
    .bubble{
      position:absolute;top:-7px;right:-7px;width:18px;height:18px;border-radius:999px;
      background:var(--danger);display:grid;place-items:center;
      font-size:11px;font-weight:1000;border:2px solid rgba(5,6,11,.9)
    }

    /* Sections */
    section{scroll-margin-top:92px}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid var(--border);
      border-radius:var(--r2);
      box-shadow:var(--shadow);
      padding:16px;
    }
    .muted{color:var(--muted)}
    .small{font-size:12px}
    .h1{font-size:32px;line-height:1.1;margin:0 0 10px}
    @media (max-width:520px){.h1{font-size:26px}}
    .lead{margin:0 0 16px;color:var(--muted);line-height:1.65}
    .heroGrid{display:grid;grid-template-columns:1.25fr .75fr;gap:16px}
    @media (max-width:920px){.heroGrid{grid-template-columns:1fr}}

    .notice{
      border:1px dashed rgba(255,255,255,.22);
      background:rgba(255,255,255,.03);
      border-radius:18px;
      padding:12px;
      color:var(--muted);
      line-height:1.6;
      font-size:13px;
    }
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;word-break:break-all}

    .sectionHead{display:flex;align-items:flex-end;justify-content:space-between;gap:12px;margin:18px 0 10px;flex-wrap:wrap}
    .sectionHead h2{margin:0;font-size:18px}

    /* Products */
    .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;margin:14px 0 10px}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{
      padding:8px 12px;border-radius:999px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.05);
      color:var(--muted);
      cursor:pointer;user-select:none;font-size:12px;font-weight:800;
    }
    .chip.active{color:#fff;border-color:rgba(30,91,255,.5);background:rgba(30,91,255,.18)}
    .search{width:min(460px,100%);padding:10px 12px;border-radius:14px;border:1px solid var(--border);background:rgba(0,0,0,.18);color:var(--text);outline:none}

    .gridProducts{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    @media (max-width:1100px){.gridProducts{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:820px){.gridProducts{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:520px){.gridProducts{grid-template-columns:1fr}}
    .product{
      border:1px solid var(--border);
      border-radius:var(--r2);
      background:rgba(255,255,255,.04);
      overflow:hidden;display:flex;flex-direction:column;min-height: 280px;
    }
    .pMedia{
      height:132px;
      background:
        radial-gradient(520px 220px at 20% 0%, rgba(30,91,255,.38), transparent 62%),
        radial-gradient(520px 220px at 80% 0%, rgba(79,124,255,.26), transparent 62%),
        rgba(0,0,0,.18);
      border-bottom:1px solid var(--border);
      display:flex;align-items:center;justify-content:center;
      position:relative;
    }
    .pBadges{position:absolute;top:10px;left:10px;display:flex;gap:8px;flex-wrap:wrap}
    .badge{font-size:11px;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,.25);border:1px solid var(--border);color:var(--muted)}
    .pBody{padding:12px;display:flex;flex-direction:column;gap:8px;flex:1}
    .pTitle{font-weight:1000;line-height:1.3}
    .pDesc{color:var(--muted);font-size:12px;line-height:1.55;min-height:34px}
    .pFooter{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-top:auto}
    .price{font-weight:1000}

    /* Drawer */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;z-index:70}
    .overlay.show{display:block}
    .drawer{
      position:fixed;top:0;bottom:0;right:0;width:min(430px, 92vw);
      background:rgba(5,6,11,.92);
      backdrop-filter: blur(12px);
      border-left:1px solid var(--border);
      box-shadow: -22px 0 44px rgba(0,0,0,.50);
      transform:translateX(105%);
      transition:transform .22s ease;
      z-index:80;
      display:flex;flex-direction:column;
    }
    [dir="ltr"] .drawer{right:auto;left:0;border-left:none;border-right:1px solid var(--border);box-shadow: 22px 0 44px rgba(0,0,0,.50);transform:translateX(-105%)}
    .drawer.show{transform:translateX(0)}
    .drawerHead{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:14px;border-bottom:1px solid var(--border)}
    .drawerBody{padding:14px;overflow:auto;display:flex;flex-direction:column;gap:10px;flex:1}
    .drawerFoot{padding:14px;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:10px}
    .cartItem{border:1px solid var(--border);border-radius:18px;background:rgba(255,255,255,.04);padding:10px;display:flex;gap:10px;align-items:center;justify-content:space-between}
    .ciName{font-weight:1000;font-size:13px;line-height:1.2}
    .ciMeta{font-size:12px;color:var(--muted);margin-top:4px}
    .qty{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);border-radius:999px;padding:6px 8px;background:rgba(0,0,0,.15)}
    .qty button{width:26px;height:26px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;font-weight:1000}
    .qty span{min-width:16px;text-align:center;font-weight:1000}

    /* Forms */
    .formGrid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:860px){.formGrid{grid-template-columns:1fr}}
    .field{display:flex;flex-direction:column;gap:6px}
    label{font-size:12px;color:var(--muted)}
    input,select,textarea{
      width:100%;padding:12px 12px;border-radius:14px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.18);
      color:var(--text);outline:none;
    }
    textarea{min-height:110px;resize:vertical}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid var(--border);text-align:start}
    th{font-size:12px;color:var(--muted);font-weight:900}

    .footer{margin-top:18px;padding:18px 0;color:var(--muted);text-align:center;border-top:1px solid var(--border);font-size:12px}

    /* WhatsApp */
    .waFloat{
      position:fixed;z-index:90;
      right:16px;bottom:16px;
      display:flex;align-items:center;gap:10px;
      padding:12px 14px;border-radius:999px;
      border:1px solid rgba(39,209,124,.35);
      background:rgba(11, 35, 22, .82);
      backdrop-filter: blur(10px);
      box-shadow: 0 16px 36px rgba(0,0,0,.50);
      cursor:pointer;user-select:none;
    }
    [dir="ltr"] .waFloat{right:auto;left:16px}
    .waDot{width:12px;height:12px;border-radius:999px;background:var(--ok);box-shadow:0 0 0 6px rgba(39,209,124,.14)}
    .waCol{display:flex;flex-direction:column;line-height:1.05}
    .waText{font-weight:1000}
    .waSub{font-size:12px;color:rgba(255,255,255,.75);margin-top:2px}
  </style>
</head>

<body>

<header class="topbar">
  <div class="container">
    <div class="brand">
      <div class="logo">DX</div>
      <div>
        <div class="brandName">DEX treading</div>
        <div class="tagline" id="tagline"></div>
      </div>
    </div>

    <nav class="nav">
      <a class="btn" href="#home" id="navHome"></a>
      <a class="btn" href="#services" id="navServices"></a>
      <a class="btn" href="#checkout" id="navCheckout"></a>

      <button class="btn cartBtn" id="openCartBtn" type="button">
        <span id="cartBtnText"></span>
        <span class="bubble" id="cartCountBubble" style="display:none">0</span>
      </button>

      <button class="btn primary" id="langBtn" type="button">EN</button>
    </nav>
  </div>
</header>

<!-- CART DRAWER -->
<div class="overlay" id="overlay"></div>
<aside class="drawer" id="drawer">
  <div class="drawerHead">
    <div style="font-weight:1000" id="cartTitle"></div>
    <button class="btn" id="closeCartBtn" type="button">✕</button>
  </div>
  <div class="drawerBody" id="cartItems"></div>
  <div class="drawerFoot">
    <div class="notice" id="cartEmptyNotice" style="display:none"></div>
    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
      <div style="font-weight:1000" id="subtotalLabel"></div>
      <div style="font-weight:1000" id="subtotalValue"></div>
    </div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn danger" id="clearCartBtn" type="button"></button>
      <a class="btn ok" href="#checkout" id="goCheckoutFromCart"></a>
    </div>
    <div class="notice small" id="waHint" style="margin-top:8px"></div>
  </div>
</aside>

<!-- WhatsApp floating button -->
<div class="waFloat" id="waFloatBtn">
  <span class="waDot"></span>
  <div class="waCol">
    <div class="waText" id="waFloatText"></div>
    <div class="waSub" id="waFloatSub"></div>
  </div>
</div>

<main>
  <!-- HOME -->
  <section id="home">
    <div class="container" style="padding-top:18px">
      <div class="heroGrid">
        <div class="card">
          <h1 class="h1" id="heroTitle"></h1>
          <p class="lead" id="heroDesc"></p>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <a class="btn primary" href="#products" id="heroShopBtn"></a>
            <a class="btn ok" href="#checkout" id="heroCheckoutBtn"></a>
            <a class="btn" href="#services" id="heroServicesBtn"></a>
          </div>
        </div>

        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
            <div>
              <div style="font-weight:1000;font-size:14px" id="ethBoxTitle"></div>
              <div class="muted small" id="ethHint"></div>
            </div>
            <button class="btn" id="copyEthTopBtn" type="button"></button>
          </div>
          <div class="notice" style="margin-top:12px">
            <div class="mono" id="ethAddress"></div>
          </div>
          <div class="notice" style="margin-top:12px">
            <div style="font-weight:1000;margin-bottom:6px" id="priceRuleTitle"></div>
            <div class="muted" id="priceRuleBody"></div>
          </div>
        </div>
      </div>

      <div class="sectionHead" id="products" style="margin-top:18px">
        <h2 id="productsTitle"></h2>
        <div class="muted" id="productsSubtitle"></div>
      </div>

      <div class="toolbar">
        <div class="chips" id="chips"></div>
        <input class="search" id="search" />
      </div>

      <div class="gridProducts" id="productsGrid"></div>

      <div class="footer" id="footerNote"></div>
    </div>
  </section>

  <!-- SERVICES -->
  <section id="services">
    <div class="container">
      <div class="sectionHead">
        <h2 id="servicesTitle"></h2>
        <div class="muted" id="servicesSubtitle"></div>
      </div>

      <div class="card">
        <div class="formGrid">
          <div>
            <h3 style="margin:0 0 10px" id="pricingTitle"></h3>
            <div class="muted small" id="pricingHint"></div>
            <div style="height:10px"></div>
            <div style="overflow:auto">
              <table>
                <thead>
                  <tr>
                    <th id="thItem"></th>
                    <th id="thCat"></th>
                    <th id="thPrice"></th>
                  </tr>
                </thead>
                <tbody id="pricingTable"></tbody>
              </table>
            </div>
          </div>

          <div>
            <h3 style="margin:0 0 10px" id="payTitle"></h3>

            <div class="notice" style="margin-bottom:10px">
              <div style="font-weight:1000" id="pay1Title"></div>
              <div class="muted" id="pay1Val"></div>
            </div>
            <div class="notice" style="margin-bottom:10px">
              <div style="font-weight:1000" id="pay2Title"></div>
              <div class="muted" id="pay2Val"></div>
            </div>
            <div class="notice" style="margin-bottom:10px">
              <div style="font-weight:1000" id="pay3Title"></div>
              <div class="muted" id="pay3Val"></div>
            </div>

            <div class="notice">
              <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
                <div>
                  <div style="font-weight:1000" id="pay4Title"></div>
                  <div class="muted small" id="pay4Hint"></div>
                </div>
                <button class="btn" id="copyEthBtn" type="button"></button>
              </div>
              <div style="height:8px"></div>
              <div class="mono" id="ethAddress2"></div>
            </div>

            <div style="height:12px"></div>
            <div class="notice" id="afterPayNote"></div>
          </div>
        </div>
      </div>

      <div class="footer">© <span id="year2"></span> DEX treading</div>
    </div>
  </section>

  <!-- CHECKOUT -->
  <section id="checkout">
    <div class="container">
      <div class="sectionHead">
        <h2 id="checkoutTitle"></h2>
        <div class="muted" id="checkoutSubtitle"></div>
      </div>

      <div class="formGrid">
        <div class="card">
          <h3 style="margin:0 0 10px" id="customerTitle"></h3>

          <form id="orderForm">
            <div class="formGrid">
              <div class="field">
                <label id="fullNameLabel"></label>
                <input id="fullName" required />
              </div>
              <div class="field">
                <label id="phoneLabel"></label>
                <input id="phone" required />
              </div>
              <div class="field">
                <label id="emailLabel"></label>
                <input id="email" type="email" required />
              </div>
              <div class="field">
                <label id="countryLabel"></label>
                <input id="country" required />
              </div>
            </div>

            <div class="field" style="margin-top:10px">
              <label id="payMethodLabel"></label>
              <select id="payMethod" required>
                <option value="Bank of Khartoum (8108407)">Bank of Khartoum (8108407)</option>
                <option value="Foory Sudan (52000220)">Foory Sudan (52000220)</option>
                <option value="Binance Pay (850037703)">Binance Pay (850037703)</option>
                <option value="Crypto (Ethereum ERC20)">Crypto (Ethereum ERC20)</option>
              </select>
            </div>

            <div class="field">
              <label id="txLabel"></label>
              <input id="txid" required />
              <div class="muted small" id="txHint"></div>
            </div>

            <div class="field">
              <label id="noteLabel"></label>
              <textarea id="note"></textarea>
            </div>

            <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
              <button class="btn ok" type="submit" id="generateBtn"></button>
              <button class="btn" type="button" id="copyOrderBtn"></button>
              <button class="btn primary" type="button" id="waOrderBtn"></button>
            </div>

            <div style="height:10px"></div>
            <div class="notice" id="checkoutHelp"></div>
          </form>
        </div>

        <div class="card">
          <h3 style="margin:0 0 10px" id="summaryTitle"></h3>

          <div class="notice" id="emptyCartCheckout"></div>

          <div id="summaryWrap" style="display:none">
            <div style="overflow:auto">
              <table>
                <thead>
                  <tr>
                    <th id="sumItem"></th>
                    <th id="sumQty"></th>
                    <th id="sumPrice"></th>
                    <th id="sumTotal"></th>
                  </tr>
                </thead>
                <tbody id="summaryTable"></tbody>
              </table>
            </div>

            <div style="height:10px"></div>
            <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
              <div style="font-weight:1000" id="totalLabel"></div>
              <div style="font-weight:1000" id="totalValue"></div>
            </div>

            <div style="height:12px"></div>
            <div class="notice" id="orderPreviewBox" style="display:none">
              <div style="font-weight:1000;margin-bottom:6px" id="orderPreviewTitle"></div>
              <div class="mono small" id="orderPreviewText"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="footer">© <span id="year3"></span> DEX treading</div>
    </div>
  </section>
</main>

<script>
  // ===== Final config =====
  const ETH_ADDRESS = "0xb56a89f790060cbb0f08d02234921e5fefff11a6";
  const WHATSAPP_NUMBER = "249112550653";
  const CURRENCY = "USD";

  const PRODUCTS = [
    { id:"c_classic", category:"Courses", tag:"Course", price:10, name_ar:"كورس تعلم التداول من الصفر - الكورس الكلاسيكي", name_en:"Trading From Zero - Classic Course", desc_ar:"محتوى منظم للمبتدئين + تطبيق عملي.", desc_en:"Structured beginner content + practice." },
    { id:"c_ict", category:"Courses", tag:"Course", price:10, name_ar:"كورس تعلم التداول من الصفر - كورس ICT", name_en:"Trading From Zero - ICT Course", desc_ar:"استراتيجية ICT مع أمثلة وتطبيق.", desc_en:"ICT concepts with examples." },
    { id:"c_smc", category:"Courses", tag:"Course", price:10, name_ar:"كورس تعلم التداول من الصفر - كورس SMC", name_en:"Trading From Zero - SMC Course", desc_ar:"Smart Money Concepts بشكل مبسط.", desc_en:"SMC simplified." },
    { id:"c_sk", category:"Courses", tag:"Course", price:10, name_ar:"كورس تعلم التداول من الصفر - كورس SK", name_en:"Trading From Zero - SK Course", desc_ar:"منهج واضح + أمثلة جاهزة.", desc_en:"Clear framework + examples." },
    { id:"usdt", category:"USDT", tag:"Service", price:10, name_ar:"شحن USDT", name_en:"USDT Top-up", desc_ar:"شحن سريع وآمن حسب التعليمات.", desc_en:"Fast & secure top-up." },
    { id:"ex_create", category:"Exness", tag:"Service", price:10, name_ar:"حسابات اكسنس - إنشاء حسابات Exness", name_en:"Exness - Account Creation", desc_ar:"إنشاء حساب مع إعدادات صحيحة.", desc_en:"Create account with correct setup." },
    { id:"ex_proof", category:"Exness", tag:"Service", price:10, name_ar:"حسابات اكسنس - توثيق السكن للحسابات الجاهزة", name_en:"Exness - Proof of Residence", desc_ar:"مساعدة في توثيق السكن للحساب.", desc_en:"Help with residence verification." },
    { id:"bot_gold", category:"Bots", tag:"Bot", price:50, name_ar:"بوتات التداول الآلي - بوت تداول الذهب", name_en:"Auto Trading Bots - Gold Bot", desc_ar:"إعدادات محسّنة لتداول الذهب.", desc_en:"Optimized settings for Gold." },
    { id:"bot_fx", category:"Bots", tag:"Bot", price:30, name_ar:"بوتات التداول الآلي - بوت تداول الأزواج", name_en:"Auto Trading Bots - FX Pairs Bot", desc_ar:"تداول أزواج الفوركس آليًا.", desc_en:"Automate FX pairs." },
    { id:"bot_stk", category:"Bots", tag:"Bot", price:30, name_ar:"بوتات التداول الآلي - بوت تداول الأسهم والمؤشرات", name_en:"Auto Trading Bots - Stocks & Indices Bot", desc_ar:"بوت للأسهم والمؤشرات.", desc_en:"Stocks & indices bot." },
    { id:"bot_crypto", category:"Bots", tag:"Bot", price:30, name_ar:"بوتات التداول الآلي - بوت تداول العملات الرقمية", name_en:"Auto Trading Bots - Crypto Bot", desc_ar:"بوت للعملات الرقمية.", desc_en:"Crypto bot." }
  ];

  const I18N = {
    ar:{
      tagline:"معًا لنشر المعرفة المالية في دول أفريقيا و شمال أفريقيا",
      navHome:"الرئيسية", navServices:"الخدمات والأسعار", navCheckout:"الدفع والشراء",
      cart:"السلة",
      heroTitle:"متجر DEX treading",
      heroDesc:"اختر المنتج وأضفه للسلة، ثم أكمل الدفع أو اطلب عبر واتساب.",
      heroShop:"تصفح المنتجات", heroCheckout:"إتمام الشراء", heroServices:"طرق الدفع",
      ethBoxTitle:"عنوان الدفع على شبكة Ethereum (ERC20)", ethHint:"أرسل USDT (ERC20) أو ETH إلى هذا العنوان فقط.", copyEth:"نسخ عنوان ETH",
      priceRuleTitle:"قواعد الأسعار", priceRuleBody:"كل المنتجات = 10$ — البوتات = 30$ — بوت الذهب = 50$",
      productsTitle:"المنتجات والخدمات", productsSubtitle:"فلتر أو ابحث ثم أضف للسلة.",
      add:"أضف للسلة",
      emptyCart:"السلة فارغة. أضف منتجات أولًا.",
      subtotal:"الإجمالي", clearCart:"تفريغ السلة", goCheckout:"الذهاب للدفع",
      waFloat:"اطلب عبر واتساب", waSub:"يرسل تفاصيل السلة",
      waHint:"يمكنك إرسال الطلب عبر واتساب مباشرة.",
      servicesTitle:"الخدمات والأسعار", servicesSub:"الأسعار بالدولار وطرق الدفع بالأسفل.",
      pricingTitle:"جدول الأسعار", pricingHint:"الأسعار ثابتة حسب القواعد المتفق عليها.",
      thItem:"المنتج/الخدمة", thCat:"التصنيف", thPrice:"السعر",
      payTitle:"طرق الدفع",
      pay1t:"بنك الخرطوم", pay1v:"رقم الحساب: 8108407",
      pay2t:"فوري سودان", pay2v:"رقم الحساب: 52000220",
      pay3t:"Binance Pay", pay3v:"المعرّف: 850037703",
      pay4t:"عملات رقمية (ERC20)", pay4h:"انسخ العنوان",
      afterPay:"بعد الدفع: اذهب لصفحة (الدفع والشراء) وأدخل رقم العملية/TxID ثم أرسل الطلب عبر واتساب.",
      checkoutTitle:"إتمام الدفع والشراء", checkoutSub:"املأ البيانات + TxID ثم (توليد الطلب).",
      customerTitle:"بيانات العميل",
      fullName:"الاسم الكامل", phone:"رقم الهاتف", email:"البريد الإلكتروني", country:"الدولة/المدينة",
      payMethod:"طريقة الدفع", tx:"TxID / رقم العملية", txHint:"مثال: رقم تحويل بنكي أو TxID للعملات الرقمية.",
      note:"ملاحظة إضافية (اختياري)",
      generate:"توليد الطلب", copyOrder:"نسخ نص الطلب", waOrder:"إرسال عبر واتساب",
      checkoutHelp:"بعد توليد الطلب اضغط إرسال عبر واتساب وسيصلنا نص الطلب كاملًا.",
      summaryTitle:"ملخص الطلب", sumItem:"الصنف", sumQty:"الكمية", sumPrice:"السعر", sumTotal:"الإجمالي",
      total:"المجموع", previewTitle:"نص الطلب الجاهز",
      chips:{all:"الكل", Courses:"الكورسات", USDT:"USDT", Exness:"Exness", Bots:"البوتات"},
      searchPh:"ابحث عن منتج…",
      footer:"واجهة متجر جاهزة للبيع (تأكيد الطلب عبر واتساب بعد الدفع)."
    },
    en:{
      tagline:"Together to spread financial knowledge in Africa & North Africa",
      navHome:"Home", navServices:"Services & Pricing", navCheckout:"Checkout",
      cart:"Cart",
      heroTitle:"DEX treading Store",
      heroDesc:"Pick an item, add to cart, then checkout — or order via WhatsApp.",
      heroShop:"Browse products", heroCheckout:"Checkout", heroServices:"Payments",
      ethBoxTitle:"Payment address on Ethereum (ERC20)", ethHint:"Send USDT (ERC20) or ETH to this address only.", copyEth:"Copy ETH address",
      priceRuleTitle:"Pricing Rules", priceRuleBody:"All items = $10 — Bots = $30 — Gold Bot = $50",
      productsTitle:"Products & Services", productsSubtitle:"Filter or search, then add to cart.",
      add:"Add to cart",
      emptyCart:"Your cart is empty. Add items first.",
      subtotal:"Total", clearCart:"Clear cart", goCheckout:"Go to checkout",
      waFloat:"Order on WhatsApp", waSub:"Sends cart details",
      waHint:"You can send the order directly on WhatsApp.",
      servicesTitle:"Services & Pricing", servicesSub:"Prices are in USD. Payment methods below.",
      pricingTitle:"Pricing Table", pricingHint:"Fixed pricing based on agreed rules.",
      thItem:"Item", thCat:"Category", thPrice:"Price",
      payTitle:"Payment Methods",
      pay1t:"Bank of Khartoum", pay1v:"Account: 8108407",
      pay2t:"Foory Sudan", pay2v:"Account: 52000220",
      pay3t:"Binance Pay", pay3v:"ID: 850037703",
      pay4t:"Crypto (ERC20)", pay4h:"Copy address",
      afterPay:"After payment: go to Checkout, enter TxID/ref, then send the order via WhatsApp.",
      checkoutTitle:"Checkout & Purchase", checkoutSub:"Fill details + TxID then Generate Order.",
      customerTitle:"Customer Info",
      fullName:"Full name", phone:"Phone", email:"Email", country:"Country/City",
      payMethod:"Payment method", tx:"TxID / Transaction ref", txHint:"Example: bank ref or crypto TxID.",
      note:"Extra note (optional)",
      generate:"Generate order", copyOrder:"Copy order text", waOrder:"Send on WhatsApp",
      checkoutHelp:"After generating, click Send on WhatsApp and we’ll receive the full order text.",
      summaryTitle:"Order Summary", sumItem:"Item", sumQty:"Qty", sumPrice:"Price", sumTotal:"Total",
      total:"Total", previewTitle:"Ready order text",
      chips:{all:"All", Courses:"Courses", USDT:"USDT", Exness:"Exness", Bots:"Bots"},
      searchPh:"Search products…",
      footer:"Sales-ready storefront (order confirmed on WhatsApp after payment)."
    }
  };

  const CART_KEY="dex_cart_v6";
  const LANG_KEY="dex_lang_v6";
  const FILTER_KEY="dex_filter_v6";

  const $ = (id)=>document.getElementById(id);
  const getLang=()=>localStorage.getItem(LANG_KEY)||"ar";
  const setLang=(l)=>{localStorage.setItem(LANG_KEY,l); applyLang(); renderAll();};
  const t=(k)=>I18N[getLang()][k];
  const getFilter=()=>localStorage.getItem(FILTER_KEY)||"all";
  const setFilter=(f)=>{localStorage.setItem(FILTER_KEY,f); renderAll();};

  const getCart=()=>{try{return JSON.parse(localStorage.getItem(CART_KEY))||[]}catch(e){return[]}};
  const saveCart=(c)=>localStorage.setItem(CART_KEY,JSON.stringify(c));

  const findP=(id)=>PRODUCTS.find(p=>p.id===id);
  const cartDetailed=()=>getCart().map(ci=>({p:findP(ci.id), qty:ci.qty})).filter(x=>x.p);
  const cartCount=()=>getCart().reduce((s,x)=>s+x.qty,0);
  const cartTotal=()=>cartDetailed().reduce((s,x)=>s+x.p.price*x.qty,0);

  function addToCart(id){
    const cart=getCart();
    const item=cart.find(x=>x.id===id);
    if(item) item.qty+=1; else cart.push({id,qty:1});
    saveCart(cart); renderAll(); openCart();
  }
  function setQty(id,qty){
    const cart=getCart().map(x=>{
      if(x.id!==id) return x;
      return {id, qty: Math.max(1, qty)};
    });
    saveCart(cart); renderAll();
  }
  function removeFromCart(id){
    saveCart(getCart().filter(x=>x.id!==id));
    renderAll();
  }
  function clearCart(){ saveCart([]); renderAll(); }

  // Drawer
  let overlay, drawer;
  function openCart(){ overlay.classList.add("show"); drawer.classList.add("show"); }
  function closeCart(){ overlay.classList.remove("show"); drawer.classList.remove("show"); }

  function escapeHtml(s){
    return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");
  }
  const norm=(s)=>String(s||"").toLowerCase();

  function buildOrderText(form){
    const items=cartDetailed();
    const lines=[];
    lines.push("DEX treading - Order");
    lines.push("--------------------------------");
    if(form){
      lines.push("Name: "+form.fullName);
      lines.push("Phone: "+form.phone);
      lines.push("Email: "+form.email);
      lines.push("Country/City: "+form.country);
      lines.push("Payment method: "+form.payMethod);
      lines.push("TxID/Ref: "+form.txid);
      if(form.note) lines.push("Note: "+form.note);
    }
    lines.push("--------------------------------");
    lines.push("Items:");
    const lang=getLang();
    items.forEach(it=>{
      const name=(lang==="ar")?it.p.name_ar:it.p.name_en;
      lines.push("- "+name+" | Qty: "+it.qty+" | "+(it.p.price*it.qty).toFixed(2)+" "+CURRENCY);
    });
    lines.push("--------------------------------");
    lines.push("TOTAL: "+cartTotal().toFixed(2)+" "+CURRENCY);
    lines.push("ETH (ERC20): "+ETH_ADDRESS);
    return lines.join("\n");
  }
  const waLink=(text)=>"https://wa.me/"+WHATSAPP_NUMBER+"?text="+encodeURIComponent(text);

  async function copyText(txt){
    try{
      if(navigator.clipboard?.writeText){ await navigator.clipboard.writeText(txt); return; }
    }catch(e){}
    const ta=document.createElement("textarea");
    ta.value=txt; document.body.appendChild(ta);
    ta.select(); try{document.execCommand("copy");}catch(e){}
    document.body.removeChild(ta);
  }

  function applyLang(){
    const lang=getLang();
    document.documentElement.lang=lang;
    document.documentElement.dir=(lang==="ar")?"rtl":"ltr";

    $("tagline").textContent = I18N[lang].tagline;
    $("navHome").textContent = I18N[lang].navHome;
    $("navServices").textContent = I18N[lang].navServices;
    $("navCheckout").textContent = I18N[lang].navCheckout;
    $("cartBtnText").textContent = I18N[lang].cart;
    $("cartTitle").textContent = I18N[lang].cart;

    $("heroTitle").textContent = I18N[lang].heroTitle;
    $("heroDesc").textContent = I18N[lang].heroDesc;
    $("heroShopBtn").textContent = I18N[lang].heroShop;
    $("heroCheckoutBtn").textContent = I18N[lang].heroCheckout;
    $("heroServicesBtn").textContent = I18N[lang].heroServices;

    $("ethBoxTitle").textContent = I18N[lang].ethBoxTitle;
    $("ethHint").textContent = I18N[lang].ethHint;
    $("copyEthTopBtn").textContent = I18N[lang].copyEth;

    $("priceRuleTitle").textContent = I18N[lang].priceRuleTitle;
    $("priceRuleBody").textContent = I18N[lang].priceRuleBody;

    $("productsTitle").textContent = I18N[lang].productsTitle;
    $("productsSubtitle").textContent = I18N[lang].productsSubtitle;
    $("search").placeholder = I18N[lang].searchPh;

    $("cartEmptyNotice").textContent = I18N[lang].emptyCart;
    $("subtotalLabel").textContent = I18N[lang].subtotal;
    $("clearCartBtn").textContent = I18N[lang].clearCart;
    $("goCheckoutFromCart").textContent = I18N[lang].goCheckout;
    $("waHint").textContent = I18N[lang].waHint;

    $("waFloatText").textContent = I18N[lang].waFloat;
    $("waFloatSub").textContent = I18N[lang].waSub;

    $("servicesTitle").textContent = I18N[lang].servicesTitle;
    $("servicesSubtitle").textContent = I18N[lang].servicesSub;
    $("pricingTitle").textContent = I18N[lang].pricingTitle;
    $("pricingHint").textContent = I18N[lang].pricingHint;
    $("thItem").textContent = I18N[lang].thItem;
    $("thCat").textContent = I18N[lang].thCat;
    $("thPrice").textContent = I18N[lang].thPrice;

    $("payTitle").textContent = I18N[lang].payTitle;
    $("pay1Title").textContent = I18N[lang].pay1t;
    $("pay1Val").textContent = I18N[lang].pay1v;
    $("pay2Title").textContent = I18N[lang].pay2t;
    $("pay2Val").textContent = I18N[lang].pay2v;
    $("pay3Title").textContent = I18N[lang].pay3t;
    $("pay3Val").textContent = I18N[lang].pay3v;
    $("pay4Title").textContent = I18N[lang].pay4t;
    $("pay4Hint").textContent = I18N[lang].pay4h;
    $("copyEthBtn").textContent = I18N[lang].copyEth;
    $("afterPayNote").textContent = I18N[lang].afterPay;

    $("checkoutTitle").textContent = I18N[lang].checkoutTitle;
    $("checkoutSubtitle").textContent = I18N[lang].checkoutSub;
    $("customerTitle").textContent = I18N[lang].customerTitle;

    $("fullNameLabel").textContent = I18N[lang].fullName;
    $("phoneLabel").textContent = I18N[lang].phone;
    $("emailLabel").textContent = I18N[lang].email;
    $("countryLabel").textContent = I18N[lang].country;
    $("payMethodLabel").textContent = I18N[lang].payMethod;
    $("txLabel").textContent = I18N[lang].tx;
    $("txHint").textContent = I18N[lang].txHint;
    $("noteLabel").textContent = I18N[lang].note;

    $("generateBtn").textContent = I18N[lang].generate;
    $("copyOrderBtn").textContent = I18N[lang].copyOrder;
    $("waOrderBtn").textContent = I18N[lang].waOrder;
    $("checkoutHelp").textContent = I18N[lang].checkoutHelp;

    $("summaryTitle").textContent = I18N[lang].summaryTitle;
    $("sumItem").textContent = I18N[lang].sumItem;
    $("sumQty").textContent = I18N[lang].sumQty;
    $("sumPrice").textContent = I18N[lang].sumPrice;
    $("sumTotal").textContent = I18N[lang].sumTotal;
    $("totalLabel").textContent = I18N[lang].total;
    $("orderPreviewTitle").textContent = I18N[lang].previewTitle;

    $("footerNote").textContent = I18N[lang].footer;

    $("langBtn").textContent = (lang==="ar") ? "EN" : "AR";
  }

  function renderChips(){
    const lang=getLang();
    const f=getFilter();
    const chips=[
      {id:"all", label:I18N[lang].chips.all},
      {id:"Courses", label:I18N[lang].chips.Courses},
      {id:"USDT", label:I18N[lang].chips.USDT},
      {id:"Exness", label:I18N[lang].chips.Exness},
      {id:"Bots", label:I18N[lang].chips.Bots},
    ];
    $("chips").innerHTML = chips.map(c=>`<div class="chip ${f===c.id?'active':''}" data-chip="${c.id}">${escapeHtml(c.label)}</div>`).join("");
    $("chips").querySelectorAll("[data-chip]").forEach(el=>{
      el.onclick=()=>setFilter(el.getAttribute("data-chip"));
    });
  }

  function renderProducts(){
    const lang=getLang();
    const q=norm($("search").value||"");
    const f=getFilter();

    const list=PRODUCTS.filter(p=>{
      if(f!=="all" && p.category!==f) return false;
      if(!q) return true;
      const title=(lang==="ar")?p.name_ar:p.name_en;
      const desc=(lang==="ar")?p.desc_ar:p.desc_en;
      return norm(title).includes(q) || norm(desc).includes(q) || norm(p.category).includes(q);
    });

    if(list.length===0){
      $("productsGrid").innerHTML = `<div class="notice" style="grid-column:1/-1">${lang==="ar"?"لا توجد نتائج.":"No results."}</div>`;
      return;
    }

    $("productsGrid").innerHTML = list.map(p=>{
      const title=(lang==="ar")?p.name_ar:p.name_en;
      const desc=(lang==="ar")?p.desc_ar:p.desc_en;
      return `
        <div class="product">
          <div class="pMedia">
            <div class="pBadges">
              <span class="badge">${escapeHtml(p.tag)}</span>
              <span class="badge">${p.price.toFixed(2)} ${CURRENCY}</span>
            </div>
            <div style="font-weight:1000;color:rgba(255,255,255,.85);font-size:28px">DX</div>
          </div>
          <div class="pBody">
            <div class="pTitle">${escapeHtml(title)}</div>
            <div class="pDesc">${escapeHtml(desc)}</div>
            <div class="pFooter">
              <div class="price">${p.price.toFixed(2)} ${CURRENCY}</div>
              <button class="btn primary" data-add="${p.id}" type="button">${I18N[lang].add}</button>
            </div>
          </div>
        </div>
      `;
    }).join("");

    $("productsGrid").querySelectorAll("[data-add]").forEach(btn=>{
      btn.onclick=()=>addToCart(btn.getAttribute("data-add"));
    });
  }

  function renderCart(){
    const items=cartDetailed();
    const lang=getLang();
    $("subtotalValue").textContent = cartTotal().toFixed(2)+" "+CURRENCY;

    const count=cartCount();
    const bubble=$("cartCountBubble");
    if(count>0){ bubble.style.display="grid"; bubble.textContent=String(count); }
    else bubble.style.display="none";

    if(items.length===0){
      $("cartEmptyNotice").style.display="block";
      $("cartItems").innerHTML="";
      return;
    }
    $("cartEmptyNotice").style.display="none";

    $("cartItems").innerHTML = items.map(it=>{
      const name=(lang==="ar")?it.p.name_ar:it.p.name_en;
      return `
        <div class="cartItem">
          <div>
            <div class="ciName">${escapeHtml(name)}</div>
            <div class="ciMeta">${it.p.price.toFixed(2)} ${CURRENCY}</div>
          </div>
          <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;justify-content:flex-end">
            <div class="qty">
              <button type="button" data-dec="${it.p.id}">−</button>
              <span>${it.qty}</span>
              <button type="button" data-inc="${it.p.id}">+</button>
            </div>
            <button class="btn danger" type="button" data-rm="${it.p.id}">✕</button>
          </div>
        </div>
      `;
    }).join("");

    $("cartItems").querySelectorAll("[data-inc]").forEach(b=>{
      b.onclick=()=>{ const id=b.getAttribute("data-inc"); const c=getCart().find(x=>x.id===id); setQty(id,(c?.qty||1)+1); };
    });
    $("cartItems").querySelectorAll("[data-dec]").forEach(b=>{
      b.onclick=()=>{ const id=b.getAttribute("data-dec"); const c=getCart().find(x=>x.id===id); setQty(id,(c?.qty||1)-1); };
    });
    $("cartItems").querySelectorAll("[data-rm]").forEach(b=>{
      b.onclick=()=>removeFromCart(b.getAttribute("data-rm"));
    });
  }

  function renderServices(){
    const lang=getLang();
    $("ethAddress2").textContent = ETH_ADDRESS;
    $("pricingTable").innerHTML = PRODUCTS.map(p=>{
      const name=(lang==="ar")?p.name_ar:p.name_en;
      return `<tr><td>${escapeHtml(name)}</td><td>${escapeHtml(p.category)}</td><td>${p.price.toFixed(2)} ${CURRENCY}</td></tr>`;
    }).join("");
  }

  function renderCheckout(){
    const items=cartDetailed();
    const lang=getLang();
    const empty=$("emptyCartCheckout");
    const wrap=$("summaryWrap");

    if(items.length===0){
      empty.textContent = I18N[lang].emptyCart;
      empty.style.display="block";
      wrap.style.display="none";
      $("orderPreviewBox").style.display="none";
      return;
    }

    empty.style.display="none";
    wrap.style.display="block";
    $("summaryTable").innerHTML = items.map(it=>{
      const name=(lang==="ar")?it.p.name_ar:it.p.name_en;
      return `<tr><td>${escapeHtml(name)}</td><td>${it.qty}</td><td>${it.p.price.toFixed(2)} ${CURRENCY}</td><td>${(it.p.price*it.qty).toFixed(2)} ${CURRENCY}</td></tr>`;
    }).join("");
    $("totalValue").textContent = cartTotal().toFixed(2)+" "+CURRENCY;
  }

  function renderAll(){
    $("ethAddress").textContent = ETH_ADDRESS;
    renderChips();
    renderProducts();
    renderCart();
    renderServices();
    renderCheckout();
  }

  function bind(){
    overlay=$("overlay"); drawer=$("drawer");
    $("openCartBtn").onclick=openCart;
    $("closeCartBtn").onclick=closeCart;
    overlay.onclick=closeCart;

    $("clearCartBtn").onclick=clearCart;
    $("goCheckoutFromCart").onclick=()=>closeCart();

    $("langBtn").onclick=()=>setLang(getLang()==="ar"?"en":"ar");
    $("search").addEventListener("input", ()=>renderProducts());

    const copyEth=async()=>{
      await copyText(ETH_ADDRESS);
      const btns=[$("copyEthTopBtn"), $("copyEthBtn")];
      btns.forEach(btn=>{
        const old=btn.textContent;
        btn.textContent="✓";
        setTimeout(()=>btn.textContent=old, 900);
      });
    };
    $("copyEthTopBtn").onclick=copyEth;
    $("copyEthBtn").onclick=copyEth;

    $("waFloatBtn").onclick=()=>{
      if(cartDetailed().length===0){ alert(I18N[getLang()].emptyCart); return; }
      window.open(waLink(buildOrderText(null)),"_blank");
    };

    $("orderForm").addEventListener("submit",(e)=>{
      e.preventDefault();
      if(cartDetailed().length===0){ alert(I18N[getLang()].emptyCart); return; }

      const form={
        fullName:$("fullName").value.trim(),
        phone:$("phone").value.trim(),
        email:$("email").value.trim(),
        country:$("country").value.trim(),
        payMethod:$("payMethod").value,
        txid:$("txid").value.trim(),
        note:$("note").value.trim()
      };
      if(!form.fullName||!form.phone||!form.email||!form.country||!form.txid){
        alert(getLang()==="ar"?"أكمل الحقول المطلوبة.":"Fill required fields.");
        return;
      }
      const txt=buildOrderText(form);
      $("orderPreviewText").textContent=txt;
      $("orderPreviewBox").style.display="block";
      localStorage.setItem("dex_last_order_v6", txt);
    });

    $("copyOrderBtn").onclick=async()=>{
      const txt=$("orderPreviewText").textContent || localStorage.getItem("dex_last_order_v6") || "";
      if(!txt){ alert(getLang()==="ar"?"قم بتوليد الطلب أولًا.":"Generate order first."); return; }
      await copyText(txt);
      const b=$("copyOrderBtn"); const old=b.textContent; b.textContent="✓"; setTimeout(()=>b.textContent=old,900);
    };

    $("waOrderBtn").onclick=()=>{
      if(cartDetailed().length===0){ alert(I18N[getLang()].emptyCart); return; }
      const txt=$("orderPreviewText").textContent || buildOrderText(null);
      window.open(waLink(txt),"_blank");
    };

    $("year2").textContent=new Date().getFullYear();
    $("year3").textContent=new Date().getFullYear();
  }

  document.addEventListener("DOMContentLoaded", ()=>{
    applyLang();
    bind();
    renderAll();
  });
</script>
</body>
  </html>
